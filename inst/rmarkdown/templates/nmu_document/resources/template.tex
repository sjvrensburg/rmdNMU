\documentclass[
$if(fontsize)$
  $fontsize$,
$endif$
$if(papersize)$
  $papersize$,
$endif$
$for(classoption)$
  $classoption$,
$endfor$
]{$if(documentclass)$$documentclass$$else$article$endif$}

% Pandoc compatibility
\providecommand{\tightlist}{\setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\providecommand{\VerbBar}{|}
\providecommand{\VERB}{}

% Essential packages
\usepackage{iftex}
\usepackage{fontspec}
\usepackage[a4paper, margin=2.54cm]{geometry}
\usepackage{xcolor}
\usepackage{graphicx}
\usepackage[protrusion=true]{microtype}

% Math and symbols
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{mathtools}
\usepackage{unicode-math}
\usepackage{amsfonts}

% Tables and lists
\usepackage{array}
\usepackage{booktabs}
\usepackage{multirow}
\usepackage{enumitem}
\usepackage{longtable}

% Text formatting
\usepackage{setspace}
\usepackage{parskip}
\usepackage{titlesec}
\usepackage{caption}

% Links and references
\usepackage{hyperref}
\usepackage{url}

% Code highlighting
$if(highlighting-macros)$
$highlighting-macros$
$endif$

% NMU Colors
\definecolor{nmuprimaryblue}{HTML}{141C2B}
\definecolor{nmusecondaryblue}{HTML}{132E51}
\definecolor{nmuprimaryyellow}{HTML}{FFCC00}
\definecolor{nmusecondaryyellow}{HTML}{F9B22A}
\definecolor{nmugrey}{HTML}{999999}
\definecolor{nmuhumanities}{HTML}{FFB51B}
\definecolor{nmueducation}{HTML}{F14F13}
\definecolor{nmubusiness}{HTML}{6C284F}
\definecolor{nmusciences}{HTML}{006B34}
\definecolor{nmuhealth}{HTML}{82B74A}
\definecolor{nmuengineering}{HTML}{57BCE9}
\definecolor{nmulaw}{HTML}{5E6EBA}
\definecolor{nmuocean}{HTML}{00AFAA}

% Font setup
\setmainfont{Nunito Sans}[
    Extension = .ttf,
    Path = $fontdir$/,
    UprightFont = NunitoSans-Regular,
    ItalicFont = NunitoSans-Italic,
    BoldFont = NunitoSans-Regular,
    BoldItalicFont = NunitoSans-Italic,
    UprightFeatures = {Weight=450, Scale=1.0},
    BoldFeatures = {Weight=700},
    ItalicFeatures = {Weight=450},
    BoldItalicFeatures = {Weight=700}
]

\usepackage[Scale=0.98,math-style=french]{lete-sans-math}

% Section formatting
\titleformat{\section}{\Large\bfseries\addfontfeatures{Weight=800}\color{nmuprimaryblue}}{\thesection}{1em}{}
\titleformat{\subsection}{\large\bfseries\addfontfeatures{Weight=700}\color{nmusecondaryblue}}{\thesubsection}{1em}{}
\titleformat{\subsubsection}{\normalsize\bfseries\addfontfeatures{Weight=700}\color{nmusecondaryblue}}{\thesubsubsection}{1em}{}

% Line spacing
\onehalfspacing

% Hyperlink setup
\hypersetup{
    colorlinks=true,
    linkcolor=nmusecondaryblue,
    filecolor=nmuprimaryblue,
    urlcolor=nmusecondaryblue,
    citecolor=nmuprimaryblue,
}

% List formatting
\setlistdepth{20}
\renewlist{itemize}{itemize}{20}
\renewlist{enumerate}{enumerate}{20}
\setlist[itemize]{noitemsep}
\setlist[enumerate]{noitemsep}

% Theorem environments
\usepackage{amsthm}
\newtheorem{theorem}{Theorem}
\newtheorem{lemma}{Lemma}
\newtheorem{definition}{Definition}
\newtheorem{example}{Example}
\newtheorem{remark}{Remark}
\newtheorem{note}{Note}

% Mathematical operators
\newcommand{\argmin}[1]{\underset{#1}{\operatorname{argmin}} \,}
\newcommand{\argmax}[1]{\underset{#1}{\operatorname{argmax}} \,}

% Default text color
\color{nmuprimaryblue}

% Title formatting
$if(title)$
\title{$title$}
$endif$
$if(author)$
\author{$author$}
$endif$
$if(date)$
\date{$date$}
$endif$

\begin{document}

$if(title)$
\maketitle
$endif$

$if(toc)$
\tableofcontents
\newpage
$endif$

$body$

\end{document}