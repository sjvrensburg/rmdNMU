\documentclass[addpoints]{exam}

% Handle font size with extsizes
\usepackage[14pt]{extsizes}

% Required packages
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{xifthen}
\usepackage{graphicx}
\usepackage[hidelinks]{hyperref}
\usepackage{booktabs}
\usepackage{multirow}
\usepackage{enumitem}
\usepackage{tikz}
\usepackage{xcolor}
\usepackage{siunitx}
\usepackage{soul}
\usetikzlibrary{calc}

% Try to use Nunito Sans if available (needs XeLaTeX or LuaLaTeX)
\usepackage{ifxetex,ifluatex}
\newif\ifxetexorluatex
\ifxetex
  \xetexorluatextrue
\else
  \ifluatex
    \xetexorluatextrue
  \else
    \xetexorluatexfalse
  \fi
\fi

\ifxetexorluatex
  \usepackage{fontspec}
  % Font configuration
  \defaultfontfeatures{
      Ligatures=TeX,
      UprightFeatures={Weight=400},  % Regular weight for normal text
      BoldFeatures={Weight=700},     % Bold weight
      ItalicFeatures={Weight=400},   % Regular weight for italics
      BoldItalicFeatures={Weight=700} % Bold weight for bold italics
  }

  \setmainfont{Nunito Sans}[
      Extension = .ttf,
      Path = /home/stefan/R/x86_64-pc-linux-gnu-library/4.3/rmdNMU/fonts/nunito-sans/,
      UprightFont = NunitoSans-Regular,
      ItalicFont = NunitoSans-Italic,
      BoldFont = NunitoSans-Regular,   % Using Regular font with weight variation
      BoldItalicFont = NunitoSans-Italic,  % Using Italic font with weight variation
      % Font Features section
      UprightFeatures = {
          Weight=450,  % Slightly heavier than regular for better readability
          Scale=1.0
      },
      BoldFeatures = {
          Weight=700  % Bold
      },
      ItalicFeatures = {
          Weight=450  % Matching upright weight
      },
      BoldItalicFeatures = {
          Weight=700  % Bold italic
      }
  ]
\fi

% Define NMU colors
\definecolor{nmuprimaryblue}{HTML}{141C2B}
\definecolor{nmusecondaryblue}{HTML}{132E51}
\definecolor{nmuprimaryyellow}{HTML}{FFCC00}
\definecolor{nmusecondaryyellow}{HTML}{F9B22A}

% Configure siunitx
\sisetup{
  group-separator = {\,},
  group-minimum-digits = 4
}

% Tightlist environment
\setlength{\emergencystretch}{3em}
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}

% Code highlighting

% Spacing
\usepackage{setspace}
\onehalfspacing
\marksnotpoints

% Style exam pages
\pagestyle{headandfoot}
\runningheadrule
\firstpageheader%
{\color{nmuprimaryblue}\large \textbf{}}%
{\color{nmuprimaryblue}\large \textbf{\Large Test 1 -- STAT314}}%
{\color{nmuprimaryblue}\large \textbf{}}

\runningheader%
{\color{nmusecondaryblue}\textbf{STAT314}}%
{\color{nmusecondaryblue}\textbf{}}%
{\color{nmusecondaryblue}\textbf{Page \thepage~of \numpages}}

\firstpagefooter%
{\color{nmusecondaryblue}\textbf{}}%
{\color{nmusecondaryblue}\textbf{}}%
{\color{nmusecondaryblue}\textbf{}}

\runningfooter%
{\color{nmusecondaryblue}\textbf{}}%
{\color{nmusecondaryblue}\textbf{}}%
{\color{nmusecondaryblue}\textbf{}}

\begin{document}

% Title section
\begin{center}
\begin{tabular}{@{} p{4cm} @{} p{10cm} @{}}
  \toprule
  \textbf{Subject:} & Statistical Methods \\[0.5em]
  \textbf{Module Code:} & STAT314 \\[0.5em]
  \textbf{Time Limit:} & 2 Hours \\[0.5em]
  \textbf{Marks:} & \numpoints \\[0.5em]
  \textbf{Examiner:} & Dr.~Smith \\
  \bottomrule
\end{tabular}
\end{center}

\vspace{1cm}

% Instructions

% Points table

% Questions section
\begin{questions}
  \question[1]What is this?

  \begin{solution}[2.2cm]
  That is a question and this is the solution.
  \end{solution}

  \question

  Suppose that we want to split a question into multiple parts.

  \begin{parts}
  \part[1]
  Is this possible?
  \begin{solution}[1cm]
  Yes!
  \end{solution}

  \part[1]
  Where do the solutions go?
  \begin{solution}[1cm]
  You just place the solution environment below the part.
  \end{solution}

  \end{parts}
\end{questions}

\end{document}
